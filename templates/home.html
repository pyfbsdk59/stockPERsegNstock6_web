{% extends 'base.html' %}

{% block content %}
<ul class="nav nav-tabs mb-3" id="stockTabs" role="tablist">
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-realtime">âš¡ å³æ™‚è©¦ç®—</button></li>
            
            <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-hist">æ­·å²è‚¡åƒ¹</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-rev">ç‡Ÿæ”¶åˆ†æ</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-net">æ·¨åˆ©è³‡æ–™</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-six">å…­å¤§æŒ‡æ¨™(è©³ç´°)</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-q4">Q4 é æ¸¬æª¢æŸ¥</button></li>
        </ul>

        <div class="tab-content" id="stockTabsContent">
            
            <div class="tab-pane fade" id="tab-realtime">
                <div class="card bg-light border-0">
                    <div class="card-body text-center">
                        <h5 class="card-title mb-3">ğŸ“ˆ å³æ™‚è‚¡åƒ¹èˆ‡é¢¨éšªå ±é…¬è©¦ç®—</h5>
                        <p class="text-muted small">ä½¿ç”¨ 2026 é æ¸¬ EPS èˆ‡æ­·å²æœ¬ç›Šæ¯”å€é–“ï¼Œçµåˆå³æ™‚è‚¡åƒ¹é€²è¡Œå‹•æ…‹è©•ä¼°ã€‚</p>
                        
                        <form method="post">
                            {% csrf_token %}
                            <input type="hidden" name="stock_id" value="{{ result.Meta.StockID }}">
                            <input type="hidden" name="year" value="{{ selected_year }}">
                            <input type="hidden" name="month" value="{{ selected_month }}">
                            
                            <button type="submit" name="calc_realtime" class="btn btn-danger btn-lg shadow-sm">
                                ğŸ”„ ç²å–å³æ™‚è‚¡åƒ¹ä¸¦è©¦ç®—
                            </button>
                        </form>

                        <hr>

                        {% if realtime_res %}
                        <div class="row g-3 justify-content-center mt-2">
                            <div class="col-md-3">
                                <div class="p-3 bg-white border rounded shadow-sm">
                                    <div class="text-muted small">å³æ™‚æˆäº¤åƒ¹</div>
                                    <div class="fs-2 fw-bold text-dark">{{ realtime_res.price }}</div>
                                </div>
                            </div>
                            
                            <div class="col-md-3">
                                <div class="p-3 bg-white border rounded shadow-sm">
                                    <div class="text-muted small">é æ¸¬ EPS (2026)</div>
                                    <div class="fs-2 fw-bold text-primary">{{ realtime_res.eps_2026 }}</div>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="p-3 bg-white border rounded shadow-sm">
                                    <div class="text-muted small">æ¡ç”¨æœ¬ç›Šæ¯”å€é–“</div>
                                    <div class="fs-5">{{ realtime_res.pe_l }} ~ {{ realtime_res.pe_h }} å€</div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3 justify-content-center mt-3">
                            <div class="col-md-4">
                                <div class="card border-success h-100">
                                    <div class="card-header bg-success text-white">ğŸš€ ä¸Šæ¼²ç©ºé–“ (Target High)</div>
                                    <div class="card-body">
                                        <h3 class="card-title text-success">{{ realtime_res.target_h }}</h3>
                                        <p class="card-text fs-5">ç©ºé–“: {{ realtime_res.upside }}</p>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="card border-danger h-100">
                                    <div class="card-header bg-danger text-white">ğŸ›¡ï¸ ä¸‹è·Œé¢¨éšª (Target Low)</div>
                                    <div class="card-body">
                                        <h3 class="card-title text-danger">{{ realtime_res.target_l }}</h3>
                                        <p class="card-text fs-5">é¢¨éšª: {{ realtime_res.downside }}</p>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="card border-info h-100">
                                    <div class="card-header bg-info text-dark">âš–ï¸ é¢¨éšªå ±é…¬æ¯” (RR)</div>
                                    <div class="card-body">
                                        <h3 class="card-title text-primary">{{ realtime_res.rr }}</h3>
                                        <p class="text-muted small">æ•¸å€¼è¶Šå¤§è¶Šå¥½ (ç²åˆ©æ½›åŠ› > é¢¨éšª)</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% else %}
                        <div class="alert alert-secondary mt-3">
                            å°šæœªé€²è¡Œè©¦ç®—ï¼Œè«‹é»æ“Šä¸Šæ–¹æŒ‰éˆ•ã€‚
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="tab-pane fade show active" id="tab-hist">
            ```

### è‡ªå‹•è·³è½‰å°æŠ€å·§

å¦‚æœæ‚¨å¸Œæœ›æŒ‰ä¸‹æŒ‰éˆ•å¾Œï¼Œé é¢é‡æ–°æ•´ç†æ™‚èƒ½**è‡ªå‹•åˆ‡æ›åˆ°ã€Œå³æ™‚è©¦ç®—ã€åˆ†é **ï¼Œå¯ä»¥åœ¨ `home.html` çš„åº•éƒ¨åŠ å…¥é€™æ®µ JavaScriptï¼š

```html
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // å¦‚æœç¶²å€åŒ…å«å³æ™‚è©¦ç®—çš„æ¨™è¨˜ (æˆ–æª¢æ¸¬åˆ°æœ‰ realtime_res)ï¼Œè‡ªå‹•åˆ‡æ› Tab
        {% if realtime_res %}
            var triggerEl = document.querySelector('button[data-bs-target="#tab-realtime"]');
            var tab = new bootstrap.Tab(triggerEl);
            tab.show();
        {% endif %}
    });
</script>
{% endblock %}